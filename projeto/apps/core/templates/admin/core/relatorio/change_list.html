{% extends "admin/change_list.html" %}
{% load i18n admin_urls static %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .relatorio-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .relatorio-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #f9f9f9;
            transition: box-shadow 0.3s;
        }
        .relatorio-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .relatorio-status {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
        }
        .status-processado {
            background-color: #d4edda;
            color: #155724;
        }
        .status-pendente {
            background-color: #fff3cd;
            color: #856404;
        }
        .relatorio-info {
            background: #e7f3ff;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .relatorio-info h3 {
            margin-top: 0;
            color: #0c5460;
        }
        .instructions-list {
            list-style-type: none;
            padding-left: 0;
        }
        .instructions-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        .instructions-list li:before {
            content: "üìã ";
            margin-right: 8px;
        }
    </style>
{% endblock %}

{% block content_title %}
    <h1>{{ title }} - Sistema de Relat√≥rios</h1>
{% endblock %}

{% block result_list %}
    <div class="relatorio-info">
        <h3>üóÇÔ∏è Sistema de Gest√£o de Relat√≥rios</h3>
        <p>Este sistema permite fazer upload e processamento autom√°tico de planilhas Excel com dados de funcion√°rios e √≥rg√£os.</p>
        
        <h4>üìã Tipos de Relat√≥rios Suportados:</h4>
        <ul class="instructions-list">
            <li><strong>Gratifica√ß√µes e Lota√ß√µes:</strong> Dados completos de funcion√°rios incluindo gratifica√ß√µes GSISTE, lota√ß√µes e hierarquia</li>
            <li><strong>√ìrg√£os Centrais e Setoriais:</strong> Informa√ß√µes sobre estrutura organizacional e valores m√°ximos da GSISTE</li>
            <li><strong>Efetivo de Funcion√°rios:</strong> Dados de efetivo atual com informa√ß√µes de lota√ß√£o e hor√°rios</li>
            <li><strong>Facilities Assistente ADM:</strong> Dados espec√≠ficos de assistentes administrativos</li>
        </ul>
        
        <h4>üîÑ Como usar:</h4>
        <ol>
            <li>Clique em "Adicionar Relat√≥rio" para fazer upload de uma planilha Excel</li>
            <li>Escolha o tipo de relat√≥rio correto</li>
            <li>Aguarde o processamento autom√°tico ou use a a√ß√£o "Processar relat√≥rios selecionados"</li>
            <li>Visualize as estat√≠sticas dos dados processados</li>
        </ol>
    </div>

    {% if cl.result_count %}
        <div class="relatorio-cards">
            {% for result in cl.result_list %}
                <div class="relatorio-card">
                    <h4>
                        <a href="{% url 'admin:core_relatorio_change' result.pk %}">{{ result.nome }}</a>
                    </h4>
                    <p><strong>Tipo:</strong> {{ result.get_tipo_display }}</p>
                    <p><strong>Upload:</strong> {{ result.data_upload|date:"d/m/Y H:i" }}</p>
                    <p><strong>Usu√°rio:</strong> {{ result.usuario_upload|default:"N√£o informado" }}</p>
                    
                    {% if result.processado %}
                        <span class="relatorio-status status-processado">‚úÖ Processado</span>
                        <p><small>Processado em: {{ result.data_processamento|date:"d/m/Y H:i" }}</small></p>
                        <a href="{% url 'admin:core_relatorio_estatisticas' result.pk %}" class="button">üìä Ver Estat√≠sticas</a>
                    {% else %}
                        <span class="relatorio-status status-pendente">‚è≥ Pendente</span>
                        <p><small>Aguardando processamento</small></p>
                    {% endif %}
                    
                    {% if result.descricao %}
                        <p><small><strong>Descri√ß√£o:</strong> {{ result.descricao|truncatewords:15 }}</small></p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {{ block.super }}
{% endblock %} 